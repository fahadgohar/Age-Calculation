<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Fahad Result</title>
  <meta name="theme-color" content="#111111" />
  <style>
    :root{
      --bg:#f6f7fb; --card:#ffffff; --text:#111; --muted:#555;
      --line:#e5e7eb; --soft:#f3f4f6; --btn:#111; --btnText:#fff;
      --shadow: 0 6px 18px rgba(0,0,0,.08);
    }
    [data-theme="dark"]{
      --bg:#0b0f19; --card:#121826; --text:#f3f4f6; --muted:#b9c0cc;
      --line:#263043; --soft:#0f1626; --btn:#f3f4f6; --btnText:#111;
      --shadow: 0 10px 28px rgba(0,0,0,.35);
    }
    body { font-family: system-ui, Arial, sans-serif; margin:0; background:var(--bg); color:var(--text); }
    .wrap { max-width: 820px; margin: 24px auto; padding: 16px; }
    .card { background:var(--card); border-radius:18px; padding:18px; box-shadow:var(--shadow); border:1px solid rgba(0,0,0,.02); }
    h1 { margin:0; font-size: 22px; letter-spacing:.2px; }
    .sub { margin:6px 0 14px; color:var(--muted); }
    .topbar{ display:flex; align-items:center; justify-content:space-between; gap:10px; }
    .toggle{
      display:flex; align-items:center; gap:10px; user-select:none;
      border:1px solid var(--line); background:transparent; color:var(--text);
      padding:10px 12px; border-radius:14px; cursor:pointer;
    }
    .grid{ display:grid; grid-template-columns:1fr; gap:12px; }
    @media (min-width: 720px){ .grid{ grid-template-columns: 1fr 1fr; } }
    label { display:block; font-weight:650; margin: 10px 0 6px; }
    input { width:100%; padding:12px; border:1px solid var(--line); border-radius:14px; font-size:16px; background:transparent; color:var(--text); }
    input::placeholder{ color: #9aa3b2; }
    .actions{ display:flex; gap:10px; flex-wrap:wrap; margin-top:12px; }
    button { padding:12px 14px; border:0; border-radius:14px; font-size:16px; font-weight:750; cursor:pointer; }
    .primary{ background:var(--btn); color:var(--btnText); flex:1; min-width: 200px; }
    .secondary{ background:transparent; color:var(--text); border:1px solid var(--line); }
    button:active { transform: scale(.99); }
    .result { margin-top:16px; padding:14px; border-radius:14px; background:var(--soft); border:1px solid var(--line); }
    .row { display:flex; gap:12px; flex-wrap:wrap; }
    .pill { background:var(--card); border:1px solid var(--line); border-radius:14px; padding:12px; flex:1; min-width: 220px; }
    .k { color:var(--muted); font-size:13px; }
    .v { font-size:20px; font-weight:900; margin-top:6px; }
    .mini { font-size:14px; font-weight:750; }
    .muted { color:var(--muted); font-size:13px; margin-top:10px; }
    .error { color:#ff5c5c; font-weight:800; margin-top:10px; display:none; }
    footer { margin-top:12px; color:var(--muted); font-size:12px; text-align:center; }
    .nameTag{ font-weight:850; }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="card">
      <div class="topbar">
        <div>
          <h1>Fahad Result</h1>
          <div class="sub">Age calculator: <b>Years</b> + <b>Extra Days</b>, plus months/weeks/hours.</div>
        </div>
        <button id="themeBtn" class="toggle" type="button" title="Toggle dark mode">
          <span id="themeIcon">ðŸŒ™</span>
          <span id="themeText">Dark</span>
        </button>
      </div>

      <div class="grid">
        <div>
          <label for="personName">Name</label>
          <input id="personName" type="text" placeholder="Enter name (optional)" />
        </div>
        <div>
          <label for="dob">Date of Birth</label>
          <input id="dob" type="date" />
        </div>
        <div>
          <label for="asOf">Calculate as of (optional)</label>
          <input id="asOf" type="date" />
        </div>
        <div>
          <label for="tzNote">Time handling</label>
          <input id="tzNote" type="text" value="Date-only (stable across timezones)" readonly />
        </div>
      </div>

      <div class="actions">
        <button id="calcBtn" class="primary" type="button">Calculate</button>
        <button id="clearBtn" class="secondary" type="button">Clear</button>
      </div>

      <div id="err" class="error"></div>

      <div id="out" class="result" style="display:none;">
        <div class="muted" id="helloLine"></div>

        <div class="row" style="margin-top:10px;">
          <div class="pill">
            <div class="k">Age (Years)</div>
            <div id="years" class="v">0</div>
            <div class="k">Extra Days after last birthday</div>
            <div id="extraDays" class="v mini">0</div>
          </div>

          <div class="pill">
            <div class="k">Total Time Lived</div>
            <div class="k" style="margin-top:10px;">Months (approx.)</div>
            <div id="months" class="v mini">0</div>
            <div class="k">Weeks (approx.)</div>
            <div id="weeks" class="v mini">0</div>
            <div class="k">Days</div>
            <div id="days" class="v mini">0</div>
          </div>

          <div class="pill">
            <div class="k">Time (based on days)</div>
            <div class="k" style="margin-top:10px;">Hours</div>
            <div id="hours" class="v mini">0</div>
            <div class="k">Minutes</div>
            <div id="minutes" class="v mini">0</div>
            <div class="k">Seconds</div>
            <div id="seconds" class="v mini">0</div>
          </div>
        </div>

        <div class="muted" id="note"></div>
      </div>

      <footer>Â© Fahad Result</footer>
    </div>
  </div>

<script>
  // ---------- Theme ----------
  const THEME_KEY = "fahad_theme";
  function setTheme(mode){
    document.documentElement.setAttribute("data-theme", mode);
    localStorage.setItem(THEME_KEY, mode);
    const isDark = mode === "dark";
    document.getElementById("themeIcon").textContent = isDark ? "â˜€ï¸" : "ðŸŒ™";
    document.getElementById("themeText").textContent = isDark ? "Light" : "Dark";
    document.querySelector('meta[name="theme-color"]').setAttribute("content", isDark ? "#0b0f19" : "#111111");
  }
  function initTheme(){
    const saved = localStorage.getItem(THEME_KEY);
    setTheme(saved || "light");
  }
  document.getElementById("themeBtn").addEventListener("click", () => {
    const cur = document.documentElement.getAttribute("data-theme") || "light";
    setTheme(cur === "dark" ? "light" : "dark");
  });

  // ---------- Date helpers (UTC date-only, stable across time zones) ----------
  function toUTCDateOnly(dateStr) {
    const [y,m,d] = dateStr.split("-").map(Number);
    return new Date(Date.UTC(y, m-1, d));
  }
  function daysBetweenUTC(a, b) {
    const ms = b.getTime() - a.getTime();
    return Math.floor(ms / (1000 * 60 * 60 * 24));
  }
  function addYearsUTC(dateUTC, years) {
    const y = dateUTC.getUTCFullYear() + years;
    const m = dateUTC.getUTCMonth();
    const d = dateUTC.getUTCDate();
    const candidate = new Date(Date.UTC(y, m, d));
    if (candidate.getUTCMonth() !== m) {
      return new Date(Date.UTC(y, m, 0)); // handle Feb 29 -> Feb 28
    }
    return candidate;
  }

  function calculateAge(dobUTC, asOfUTC) {
    if (asOfUTC.getTime() < dobUTC.getTime()) {
      throw new Error("As-of date cannot be before date of birth.");
    }

    const totalDays = daysBetweenUTC(dobUTC, asOfUTC);

    // full years
    let years = asOfUTC.getUTCFullYear() - dobUTC.getUTCFullYear();
    let thisYearBday = addYearsUTC(dobUTC, years);
    if (thisYearBday.getTime() > asOfUTC.getTime()) {
      years--;
      thisYearBday = addYearsUTC(dobUTC, years);
    }

    const extraDays = daysBetweenUTC(thisYearBday, asOfUTC);

    // Approximations for months/weeks (months approx = days/30.4375)
    const monthsApprox = totalDays / 30.4375;
    const weeksApprox = totalDays / 7;

    // Hours/minutes/seconds derived from day count (date-only approach)
    const hours = totalDays * 24;
    const minutes = hours * 60;
    const seconds = minutes * 60;

    return {
      years,
      extraDays,
      totalDays,
      monthsApprox,
      weeksApprox,
      hours,
      minutes,
      seconds,
      lastBirthdayUTC: thisYearBday
    };
  }

  // ---------- UI + storage ----------
  const SAVE_KEY = "fahad_last_inputs";

  function showError(msg) {
    const err = document.getElementById("err");
    err.textContent = msg;
    err.style.display = "block";
    document.getElementById("out").style.display = "none";
  }
  function clearError() {
    const err = document.getElementById("err");
    err.textContent = "";
    err.style.display = "none";
  }

  function saveInputs() {
    const payload = {
      name: document.getElementById("personName").value || "",
      dob: document.getElementById("dob").value || ""
    };
    localStorage.setItem(SAVE_KEY, JSON.stringify(payload));
  }
  function loadInputs() {
    try{
      const raw = localStorage.getItem(SAVE_KEY);
      if(!raw) return;
      const obj = JSON.parse(raw);
      if(obj.name) document.getElementById("personName").value = obj.name;
      if(obj.dob) document.getElementById("dob").value = obj.dob;
    }catch(_){}
  }

  document.getElementById("calcBtn").addEventListener("click", () => {
    clearError();

    const name = document.getElementById("personName").value.trim();
    const dobVal = document.getElementById("dob").value;
    const asOfVal = document.getElementById("asOf").value;

    if (!dobVal) return showError("Please select a Date of Birth.");

    const dobUTC = toUTCDateOnly(dobVal);

    // Default as-of = today (device local), converted to UTC date-only
    let asOfUTC;
    if (asOfVal) {
      asOfUTC = toUTCDateOnly(asOfVal);
    } else {
      const now = new Date();
      asOfUTC = new Date(Date.UTC(now.getFullYear(), now.getMonth(), now.getDate()));
    }

    try {
      const r = calculateAge(dobUTC, asOfUTC);

      document.getElementById("helloLine").innerHTML =
        name ? `Result for <span class="nameTag">${escapeHtml(name)}</span>:` : `Result:`;

      document.getElementById("years").textContent = r.years;
      document.getElementById("extraDays").textContent = r.extraDays;

      document.getElementById("days").textContent = r.totalDays.toLocaleString();
      document.getElementById("weeks").textContent = r.weeksApprox.toFixed(2).toLocaleString();
      document.getElementById("months").textContent = r.monthsApprox.toFixed(2).toLocaleString();

      document.getElementById("hours").textContent = r.hours.toLocaleString();
      document.getElementById("minutes").textContent = r.minutes.toLocaleString();
      document.getElementById("seconds").textContent = r.seconds.toLocaleString();

      const lastBday = `${r.lastBirthdayUTC.getUTCFullYear()}-${String(r.lastBirthdayUTC.getUTCMonth()+1).padStart(2,"0")}-${String(r.lastBirthdayUTC.getUTCDate()).padStart(2,"0")}`;
      document.getElementById("note").textContent =
        `Calculated as of: ${asOfUTC.toISOString().slice(0,10)} | Last birthday: ${lastBday}`;

      document.getElementById("out").style.display = "block";

      saveInputs();
    } catch (e) {
      showError(e.message || "Something went wrong.");
    }
  });

  document.getElementById("clearBtn").addEventListener("click", () => {
    document.getElementById("personName").value = "";
    document.getElementById("dob").value = "";
    document.getElementById("asOf").value = "";
    localStorage.removeItem(SAVE_KEY);
    clearError();
    document.getElementById("out").style.display = "none";
  });

  function escapeHtml(s){
    return s.replace(/[&<>"']/g, (c) => ({
      "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"
    }[c]));
  }

  // Init
  initTheme();
  loadInputs();
</script>
</body>
</html>


